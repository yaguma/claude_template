# アトリエ錬金術ゲーム 要件定義書

## 概要

本ゲームは、錬金術をテーマにした短期ローグライク × デッキ構築ゲームである。
プレイヤーは錬金術師として、カードを組み合わせて顧客の依頼を達成し、工房を発展させる。

**ジャンル**: 錬金術 × 短期ローグライク × デッキ構築
**コンセプト**: 「混ぜて、暴発して、満足させろ。」
**プレイ時間**: 1プレイ 20〜40分

## 関連文書

- **ユーザストーリー**: [📖 atelier-user-stories.md](atelier-user-stories.md)
- **受け入れ基準**: [✅ atelier-acceptance-criteria.md](atelier-acceptance-criteria.md)

---

## 機能要件(EARS記法)

**【信頼性レベル凡例】**:
- 🔵 **青信号**: EARS要件定義書・設計文書・ユーザヒアリングを参考にした確実な要件
- 🟡 **黄信号**: EARS要件定義書・設計文書・ユーザヒアリングから妥当な推測による要件
- 🔴 **赤信号**: EARS要件定義書・設計文書・ユーザヒアリングにない推測による要件

---

### 1. プラットフォーム・技術基盤

#### 通常要件

- **REQ-001**: システムはUnity(C#)で開発されなければならない 🔵 *ユーザヒアリング質問2-1より*
- **REQ-002**: システムはWindows版を優先的にサポートしなければならない 🔵 *ユーザヒアリング質問2-2より*
- **REQ-003**: システムはフルHD(1920x1080)固定解像度で動作しなければならない 🔵 *ユーザヒアリング質問4-2より*
- **REQ-004**: システムは2Dドット絵スタイルのグラフィックを使用しなければならない 🔵 *ユーザヒアリング質問4-1より*
- **REQ-005**: システムはマウスとキーボードの両方で操作可能でなければならない 🔵 *ユーザヒアリング質問4-3より*

#### 制約要件

- **REQ-006**: システムは5年以上前の低スペックPCで動作しなければならない 🔵 *ユーザヒアリング質問9-1より*
- **REQ-007**: システムの起動時間は5秒以内でなければならない 🔵 *ユーザヒアリング質問9-2より*
- **REQ-008**: システムは完全オフラインで動作しなければならない 🔵 *ユーザヒアリング質問3-3より*

#### オプション要件

- **REQ-009**: システムは将来的にiOS・Android版に展開してもよい 🟡 *ユーザヒアリング質問2-2から推測*

---

### 2. データ管理・セーブシステム

#### 通常要件

- **REQ-010**: システムはセーブデータをローカルファイルに保存しなければならない 🔵 *ユーザヒアリング質問3-1より*
- **REQ-010-1**: システムは最低3つのセーブスロットを提供しなければならない 🔴 *ローグライクゲームの一般要件から推測*
- **REQ-011**: システムはメタ進行データ(工房設備Lv、顧客関係値、知識ポイント)を永続保存しなければならない 🔵 *ユーザヒアリング質問3-2より*
- **REQ-012**: システムはプレイ途中のセーブ・ロード機能を提供しなければならない 🔵 *ユーザヒアリング質問5-4より*

#### 制約要件

- **REQ-013**: システムはチート対策を実装する必要はない 🔵 *ユーザヒアリング質問9-3(訂正)より*

---

### 3. ゲームフロー・プレイ進行

#### 通常要件

- **REQ-014**: システムはゲーム開始時に錬金スタイル(初期デッキタイプ)を選択させなければならない 🔵 *README.md ゲームフロー表より*
- **REQ-015**: システムはノード進行型のマップ構造を提供しなければならない 🔵 *README.md マップ構造より*
- **REQ-015-1**: システムは1プレイあたり30〜50個のノードを配置しなければならない 🔴 *プレイ時間20〜40分から逆算して推測*
- **REQ-016**: システムは依頼、商人、実験、魔物、ボス依頼のノードタイプを提供しなければならない 🔵 *README.md マップ構造表より*
- **REQ-016-1**: 実験ノードはランダムイベントを発生させ、成功時に報酬、失敗時に暴発しなければならない 🔵 *README.md マップ構造表より*
- **REQ-016-2**: 魔物ノードは素材入手のための戦闘を提供しなければならない 🔵 *README.md マップ構造表より*
- **REQ-017**: システムは最終依頼(高難度レシピ制作)をクリア目標として設定しなければならない 🔵 *README.md ゲームフロー表より*

#### オプション要件

- **REQ-018**: システムはプレイ時間を20〜40分程度に調整してもよい 🔵 *README.md プレイ時間より*

---

### 4. 錬金スタイル(初期デッキ)

#### 通常要件

- **REQ-019**: システムはMVPとして最低1つの錬金スタイルを提供しなければならない 🔵 *ユーザヒアリング質問10-1より*

#### オプション要件

- **REQ-020**: システムは将来的に火の錬金術師、水の錬金術師、毒の錬金術師、鉱の錬金術師、精霊錬金術師の5スタイルを実装してもよい 🟡 *README.md 錬金スタイル表 + ユーザヒアリング質問10-1から推測(将来実装)*

#### 条件付き要件

- **REQ-021**: MVPリリース後に追加スタイルを実装する場合、各スタイルは異なる属性・戦略を持たなければならない 🟡 *README.md 錬金スタイル表から推測*

---

### 5. カードシステム

#### 通常要件

- **REQ-022**: システムは素材カード、操作カード、触媒カード、知識カード、特殊カード、アーティファクトの6系統を提供しなければならない 🔵 *README.md カード系統一覧表より*
- **REQ-023**: 各カードは属性値、安定値、反応効果を持たなければならない 🔵 *README.md カードシステム概要表より*
- **REQ-024**: システムはカードにエネルギー/コストの概念を実装しなければならない 🔵 *ユーザヒアリング質問6-4より*
- **REQ-024-1**: システムは各ターン開始時にエネルギーを3提供しなければならない 🔴 *デッキ構築ゲームの一般要件から推測*
- **REQ-024-2**: システムはエネルギーの最大値を10に設定しなければならない 🔴 *デッキ構築ゲームの一般要件から推測*
- **REQ-024-3**: 各カードは0〜5のコストを持たなければならない 🔴 *デッキ構築ゲームの一般要件から推測*
- **REQ-025**: システムはカードの合成・進化システムを実装しなければならない 🔵 *ユーザヒアリング質問6-2より*
- **REQ-026**: システムはデッキ枚数に制限を設けてはならない 🔵 *ユーザヒアリング質問5-3より*
- **REQ-026-1**: システムは初期手札枚数を5枚に設定しなければならない 🔴 *デッキ構築ゲームの一般要件から推測*
- **REQ-026-2**: システムは毎ターン開始時に手札が5枚になるようドローしなければならない 🔴 *デッキ構築ゲームの一般要件から推測*
- **REQ-026-3**: システムはデッキからカードを削除する機能を提供しなければならない 🔴 *デッキ構築ゲームの一般要件から推測*

#### 条件付き要件

- **REQ-027**: 同じカードを複数枚集めた場合、システムはそれらを合成して進化させることができなければならない 🔵 *ユーザヒアリング質問6-2より*
- **REQ-028**: デッキ構築によって手札枚数が変動する場合、システムはその枚数を計算して反映しなければならない 🔴 *ユーザヒアリング質問6-3より - MustHaveに変更*
- **REQ-028-1**: 特定のカードやアーティファクトによって手札枚数が+1〜+3される場合、システムはその効果を適用しなければならない 🔴 *手札変動の具体例として推測*

---

### 6. 顧客(戦闘)システム

#### 通常要件

- **REQ-029**: システムは同時に3件の顧客依頼を受けられなければならない 🔵 *ユーザヒアリング質問7-1より*
- **REQ-030**: 各依頼は指定属性値、品質、安定性の条件を持たなければならない 🔵 *README.md 顧客フェーズより*
- **REQ-031**: システムは依頼の難易度を1〜5の星で表示しなければならない 🟡 *ユーザヒアリング質問7-2から推測(1星=簡単、5星=最高難易度)*
- **REQ-032**: システムはMVPとして最低5種類の顧客タイプを提供しなければならない 🟡 *ユーザヒアリング質問7-5から推測(MVP範囲)*
- **REQ-032-1**: システムは正式リリース時に20種類以上の顧客タイプを提供しなければならない 🔵 *ユーザヒアリング質問7-5より*

#### 条件付き要件

- **REQ-033**: 安定値が閾値(0)を下回った場合、システムは暴発を発生させなければならない 🔵 *ユーザヒアリング質問7-4より*
- **REQ-033-1**: 暴発が発生した場合、システムは名声を1減少させなければならない 🟡 *README.md 顧客フェーズの失敗ペナルティより*
- **REQ-033-2**: 暴発が発生した場合、システムはランダムでデッキから1枚のカードをロストさせてもよい 🟡 *README.md 顧客フェーズの失敗ペナルティより*
- **REQ-034**: 依頼の条件を満たした場合、システムは依頼を達成状態にしなければならない 🔵 *README.md 顧客フェーズより*
- **REQ-035**: 満足度ゲージを満たした場合、システムは依頼を達成状態にしてもよい 🟡 *README.md 顧客フェーズから推測*

---

### 7. 報酬・成長システム

#### 通常要件

- **REQ-036**: システムは依頼達成時に新カードを報酬として提供しなければならない 🔵 *README.md ゲームフロー表 + ユーザヒアリング質問6-1より*
- **REQ-037**: システムは商人ノードでカードの購入・強化を可能にしなければならない 🔵 *README.md マップ構造表より*
- **REQ-038**: システムは触媒の入手手段を提供しなければならない 🟡 *README.md ゲームフロー表から推測*

---

### 8. メタ進行システム

#### 通常要件

- **REQ-039**: システムは名声と知識ポイントの2種類のメタ通貨を管理しなければならない 🔵 *ユーザヒアリング質問8-1より*
- **REQ-039-1**: システムは依頼達成時に名声を獲得させなければならない 🟡 *メタ進行の一般要件から推測*
- **REQ-039-2**: システムはゲームクリア時に知識ポイントを獲得させなければならない 🟡 *メタ進行の一般要件から推測*
- **REQ-040**: システムはメタ通貨を使用して新カード・新素材をアンロックできなければならない 🔵 *ユーザヒアリング質問8-2より*
- **REQ-041**: システムはアセンション式の難易度システムを実装しなければならない 🔵 *ユーザヒアリング質問5-2より*
- **REQ-041-1**: システムはアセンション難易度を最大20レベルまで実装しなければならない 🔴 *やりこみ要素として推測*
- **REQ-042**: システムはシード値入力機能を提供し、再現プレイを可能にしなければならない 🔵 *ユーザヒアリング質問8-3より*

#### 条件付き要件

- **REQ-043**: 周回を重ねた場合、システムは難易度を段階的に上昇させなければならない 🔵 *ユーザヒアリング質問5-2より*
- **REQ-044**: 新素材・新顧客がアンロックされた場合、システムは以降のプレイでそれらを出現させなければならない 🟡 *README.md メタ進行表から推測*

---

### 9. UI/UX要件

#### 通常要件

- **REQ-045**: システムは依頼ボードで各依頼の進行状況を表示しなければならない 🟡 *README.md 依頼ボード例から推測*
- **REQ-046**: システムはマップ画面でノードの種類を視覚的に区別できなければならない 🟡 *README.md マップ構造から推測*
- **REQ-047**: システムは手札、デッキ、捨て札の状態を表示しなければならない 🔴 *デッキ構築ゲームの一般的な要件から推測*
- **REQ-047-1**: システムはカード操作のアンドゥ機能を提供しなければならない 🔴 *ユーザビリティ要求から推測*

#### 制約要件

- **REQ-048**: システムは最低限のアクセシビリティ対応でよい 🔵 *ユーザヒアリング質問4-4より*
- **REQ-048-1**: システムはカードの属性を色だけでなくアイコンでも識別可能にしなければならない 🔴 *色覚多様性対応の一般要件から推測*

---

### 10. サウンド要件

#### 通常要件

- **REQ-049**: システムはBGMとSEの両方を実装しなければならない 🔵 *ユーザヒアリング質問9-5より*
- **REQ-050**: システムは音量調整機能を提供しなければならない 🔴 *ゲーム一般要件から推測*

---

## 非機能要件

### パフォーマンス

- **NFR-001**: システムは起動から5秒以内にメニュー画面を表示しなければならない 🔵 *ユーザヒアリング質問9-2より*
- **NFR-002**: システムはCPU: Core i3相当(第4世代以上)、メモリ: 4GB以上、GPU: オンボードグラフィックスの環境で60FPS以上を維持しなければならない 🟡 *ユーザヒアリング質問9-1から推測*
- **NFR-003**: システムはカード操作時の応答時間を100ms以内にしなければならない 🔴 *ゲーム操作の一般要件から推測*

### セキュリティ

- **NFR-004**: システムはセーブデータの暗号化を実装する必要はない 🔵 *ユーザヒアリング質問9-3(訂正)より*

### ユーザビリティ

- **NFR-005**: システムは日本語UIのみをサポートすればよい 🔵 *ユーザヒアリング質問9-4より*
- **NFR-006**: システムはチュートリアル機能を提供しなければならない 🔴 *新規プレイヤー向け一般要件から推測*
- **NFR-007**: システムは操作方法のヘルプ機能を提供しなければならない 🔴 *ユーザビリティ一般要件から推測*

### 保守性

- **NFR-008**: システムはカードデータをJSON等の外部ファイルで管理しなければならない 🔴 *保守性・拡張性の一般要件から推測*
- **NFR-009**: システムはログ機能を実装し、デバッグを容易にしなければならない 🔴 *開発効率の一般要件から推測*

### 移植性

- **NFR-010**: システムは将来的にiOS・Android版への移植を考慮した設計でなければならない 🟡 *ユーザヒアリング質問2-2から推測*

---

## Edgeケース

### エラー処理

- **EDGE-001**: セーブデータが破損している場合、システムは新規ゲームとして起動し、警告メッセージを表示しなければならない 🔴 *エラー処理一般要件から推測*
- **EDGE-002**: ディスク容量不足でセーブできない場合、システムはエラーメッセージを表示し、セーブを中止しなければならない 🔴 *エラー処理一般要件から推測*

### 境界値

- **EDGE-003**: デッキ枚数が1000枚を超えた場合、システムは警告メッセージを表示してもよい 🔴 *想定外の使用パターンから推測*
- **EDGE-004**: エネルギーがマイナスになった場合、システムは0として扱わなければならない 🔴 *計算エラー回避の一般要件から推測*
- **EDGE-005**: 安定値がマイナス値に到達した場合、システムは暴発を強制発生させなければならない 🟡 *ユーザヒアリング質問7-4から推測*

### データ整合性

- **EDGE-006**: 同時に3件を超える依頼が発生した場合、システムは古い依頼を自動的に破棄しなければならない 🔴 *データ整合性の一般要件から推測*
- **EDGE-007**: カード進化中に不正なデータが検出された場合、システムは進化を中止し、元のカードを保持しなければならない 🔴 *データ整合性の一般要件から推測*

---

## 制約事項

### 技術的制約

- Unity 2021.3 LTS以降を使用
- .NET Standard 2.1準拠
- プラットフォーム: Windows 10以降

### ビジネス制約

- 無料配布(収益化なし)
- 開発期限は設定しない
- 個人開発プロジェクト

### 設計制約

- オフライン動作必須
- 外部ライブラリの使用は最小限
- アセット容量は500MB以内を目標

---

## 優先順位(MoSCoW法)

### Must Have(必須 - MVP範囲)

- REQ-001〜008(プラットフォーム基盤)
- REQ-010〜013(データ管理)
- REQ-010-1(セーブスロット3つ)
- REQ-014〜017(基本ゲームフロー)
- REQ-015-1(ノード数30〜50個)
- REQ-016-1〜016-2(実験・魔物ノード詳細)
- REQ-019(最低1スタイル)
- REQ-022〜026(カードシステム基本)
- REQ-024-1〜024-3(エネルギーシステム詳細)
- REQ-026-1〜026-3(手札システム詳細、カード削除機能)
- REQ-028(手札枚数変動ルール)
- REQ-028-1(手札枚数変動の具体例)
- REQ-029〜034(顧客システム基本)
- REQ-031(難易度1〜5星表示)
- REQ-032(最低5種類の顧客)
- REQ-033-1〜033-2(暴発ペナルティ)
- REQ-036(報酬システム)
- REQ-047-1(カード操作アンドゥ機能)
- REQ-048-1(色覚多様性対応)

### Should Have(推奨 - 正式リリース範囲)

- REQ-020(全5スタイル)
- REQ-032-1(20種類以上の顧客)
- REQ-037〜038(成長システム)
- REQ-039〜044(メタ進行)
- REQ-039-1〜039-2(メタ通貨獲得条件)
- REQ-041-1(アセンション最大20レベル)
- REQ-045〜047(UI/UX基本)
- REQ-049〜050(サウンド)
- NFR-001〜003(パフォーマンス)

### Could Have(あれば良い)

- REQ-009(iOS・Android版)
- REQ-018(プレイ時間調整)
- NFR-006〜007(チュートリアル・ヘルプ)

### Won't Have(今回は対象外)

- 多言語対応
- オンライン機能
- 実績・トロフィー機能
- チート対策

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2025-11-08 | 1.0 | 初版作成 |
| 2025-11-08 | 1.1 | レビュー指摘事項の修正(高優先度): REQ-020をオプション要件に変更、エネルギー/手札/暴発の詳細要件追加(REQ-024-1〜3, REQ-026-1〜2, REQ-028-1, REQ-033-1〜2)、REQ-028をMustHaveに変更、優先順位セクション更新 |
| 2025-11-08 | 1.2 | レビュー指摘事項の修正(中優先度): 顧客数を段階的に定義(REQ-032, REQ-032-1)、難易度表示を1〜5星に具体化(REQ-031)、ノード数要件追加(REQ-015-1)、実験・魔物ノード詳細追加(REQ-016-1〜2)、セーブスロット数定義(REQ-010-1)、アセンション最大レベル定義(REQ-041-1)、メタ通貨獲得条件追加(REQ-039-1〜2)、優先順位セクション更新 |
| 2025-11-08 | 1.3 | レビュー指摘事項の修正(低優先度): カード削除機能追加(REQ-026-3)、UIアンドゥ機能追加(REQ-047-1)、アクセシビリティ要件具体化(REQ-048-1)、優先順位セクション更新 |

