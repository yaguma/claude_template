# アトリエ錬金術ゲーム 受け入れ基準

## 概要

このドキュメントは、錬金術×ローグライク×デッキ構築ゲーム「アトリエ」の受け入れ基準とテスト項目を記載する。

---

## 機能テスト基準

**【信頼性レベル凡例】**:
- 🔵 **青信号**: EARS要件定義書・設計文書・ユーザヒアリングを参考にした確実なテスト基準
- 🟡 **黄信号**: EARS要件定義書・設計文書・ユーザヒアリングから妥当な推測によるテスト基準
- 🔴 **赤信号**: EARS要件定義書・設計文書・ユーザヒアリングにない推測によるテスト基準

---

### 1. プラットフォーム・起動テスト

#### REQ-001〜008: プラットフォーム基盤の受け入れ基準 🔵

**Given(前提条件)**:
- Windows 10以降のOSがインストールされたPC
- 最低スペック: Core i3第4世代、メモリ4GB、オンボードグラフィックス

**When(実行条件)**:
- ゲームの実行ファイルをダブルクリックで起動

**Then(期待結果)**:
- 5秒以内にタイトル画面が表示される
- フルHD(1920x1080)の解像度で描画される
- マウスでUIをクリック可能
- キーボードで操作可能
- オフラインで動作する

**テストケース**:
- [x] 正常系: Windows 10での起動確認
- [x] 正常系: Windows 11での起動確認
- [x] 正常系: 低スペックPC(Core i3-4000系、メモリ4GB)での動作確認
- [x] 正常系: 起動時間が5秒以内であることを計測
- [x] 異常系: インターネット接続なしで起動・プレイ可能
- [x] 境界値: 最低スペックで60FPS維持

---

### 2. セーブ・ロードシステム

#### REQ-010〜013: データ管理の受け入れ基準 🔵

**Given(前提条件)**:
- ゲームがプレイ中の状態
- セーブデータ保存先のディレクトリが存在する

**When(実行条件)**:
- セーブボタンをクリック、またはゲーム終了時に自動セーブ

**Then(期待結果)**:
- ローカルファイルにセーブデータが保存される
- メタ進行データ(工房設備Lv、知識ポイント等)が永続保存される
- 次回起動時に続きからプレイ可能

**テストケース**:
- [x] 正常系: プレイ途中でセーブ→ゲーム再起動→ロードして続行
- [x] 正常系: メタ通貨を獲得→ゲーム再起動→メタ通貨が保持されている
- [x] 正常系: 複数のセーブスロットが使用可能
- [x] 異常系: ディスク容量不足時のエラーハンドリング
- [x] 異常系: セーブデータ破損時の復旧またはエラー表示
- [x] 境界値: セーブデータサイズが10MB以下

---

### 3. スタイル選択

#### REQ-014, REQ-019: 錬金スタイル選択の受け入れ基準 🔵

**Given(前提条件)**:
- 新規ゲームを開始した状態
- スタイル選択画面が表示されている

**When(実行条件)**:
- 錬金スタイル(MVP: 最低1種類)を選択

**Then(期待結果)**:
- 選択したスタイルに対応する初期デッキが設定される
- ゲームがマップ画面に遷移する

**テストケース**:
- [x] 正常系: スタイルを1つ選択して開始
- [x] 正常系: 選択したスタイルの初期カードがデッキに含まれる
- [x] 異常系: スタイル未選択で開始ボタンを押した場合のエラー処理

---

### 4. マップ進行とノード選択

#### REQ-015〜017: マップ構造の受け入れ基準 🔵

**Given(前提条件)**:
- ゲームがマップ画面に表示されている
- 複数のノードが選択可能

**When(実行条件)**:
- 依頼、商人、実験、魔物、ボス依頼のいずれかのノードを選択

**Then(期待結果)**:
- 選択したノードに対応する画面に遷移する
- ノードクリア後、次のノード選択画面に戻る
- 最終依頼をクリアするとゲームクリアとなる

**テストケース**:
- [x] 正常系: 依頼ノードを選択→依頼画面に遷移
- [x] 正常系: 商人ノードを選択→商人画面に遷移
- [x] 正常系: 実験ノードを選択→イベント発生
- [x] 正常系: 魔物ノードを選択→戦闘画面に遷移
- [x] 正常系: ボス依頼をクリア→次エリアまたはゲームクリア
- [x] 異常系: 到達不可能なノードを選択できない
- [x] 境界値: マップ上のノード数が30〜50個

---

### 5. カードシステム

#### REQ-022〜028: カードの受け入れ基準 🔵

**Given(前提条件)**:
- プレイヤーがカードを所持している
- デッキが構築されている

**When(実行条件)**:
- カードをプレイする
- 同じカードを複数枚集めて合成する

**Then(期待結果)**:
- カードの属性値、安定値、反応効果が適用される
- エネルギー/コストが消費される
- 合成により強力なカードに進化する
- デッキ枚数に制限がない

**テストケース**:
- [x] 正常系: カードをプレイ→属性値が依頼に加算される
- [x] 正常系: エネルギー不足でカードをプレイできない
- [x] 正常系: 同じカード3枚を合成→進化したカードを獲得
- [x] 正常系: デッキに100枚以上のカードを追加可能
- [x] 正常系: 手札枚数がデッキ構築により変動する
- [x] 異常系: 不正なカードデータの場合はエラー表示
- [x] 境界値: エネルギーが0の時にコスト1のカードはプレイ不可
- [x] 境界値: デッキ枚数1000枚で動作確認

---

### 6. 顧客依頼システム(戦闘)

#### REQ-029〜035: 顧客依頼の受け入れ基準 🔵

**Given(前提条件)**:
- 依頼ノードに到達している
- 3件の依頼が表示されている

**When(実行条件)**:
- カードをプレイして依頼の条件を満たす

**Then(期待結果)**:
- 依頼の進行状況が更新される
- 条件を満たすと依頼が達成される
- 安定値が閾値を下回ると暴発が発生する

**テストケース**:
- [x] 正常系: 依頼の条件(属性値、品質、安定性)を満たす→達成
- [x] 正常系: 3件同時に進行可能
- [x] 正常系: 依頼の難易度が星で表示される
- [x] 正常系: 安定値が閾値を下回る→暴発発生
- [x] 正常系: 満足度ゲージを満たす→依頼達成
- [x] 異常系: 依頼失敗時のペナルティ処理(未定義)
- [x] 境界値: 安定値が0の時に暴発確定
- [x] 境界値: 顧客タイプが20〜30種類実装されている

---

### 7. 報酬システム

#### REQ-036〜038: 報酬の受け入れ基準 🔵

**Given(前提条件)**:
- 依頼を達成した状態
- 商人ノードに到達した状態

**When(実行条件)**:
- 報酬画面でカードを選択
- 商人でカードを購入

**Then(期待結果)**:
- 新しいカードがデッキに追加される
- 通貨が消費され、カードが強化される

**テストケース**:
- [x] 正常系: 依頼達成→報酬カードを3枚から1枚選択
- [x] 正常系: 商人でカード購入→通貨が減少、カードが追加
- [x] 正常系: 商人でカード強化→通貨が減少、カードが強化される
- [x] 異常系: 通貨不足で購入できない
- [x] 境界値: 通貨が0の時に購入不可

---

### 8. メタ進行システム

#### REQ-039〜044: メタ進行の受け入れ基準 🔵

**Given(前提条件)**:
- 1プレイを終了した状態
- メタ通貨を獲得している

**When(実行条件)**:
- メタ通貨を使用して新要素をアンロック
- アセンション難易度を選択

**Then(期待結果)**:
- 名声と知識ポイントが永続保存される
- 新カード・新素材がアンロックされる
- アセンション難易度が段階的に上昇する
- シード値で再現プレイが可能

**テストケース**:
- [x] 正常系: プレイ終了→メタ通貨獲得→次回プレイで保持
- [x] 正常系: メタ通貨でカードアンロック→以降のプレイで出現
- [x] 正常系: アセンション難易度1→クリア→難易度2が解放
- [x] 正常系: シード値入力→同じマップ構成で開始
- [x] 正常系: 周回を重ねる→難易度が段階的に上昇
- [x] 異常系: メタ通貨不足でアンロック不可
- [x] 境界値: アセンション難易度20まで実装

---

### 9. UI/UX

#### REQ-045〜048: UI/UXの受け入れ基準 🟡

**Given(前提条件)**:
- ゲーム画面が表示されている

**When(実行条件)**:
- 依頼ボード、マップ画面、デッキ画面を表示

**Then(期待結果)**:
- 依頼の進行状況が視覚的に分かる
- ノードの種類がアイコンで区別できる
- 手札、デッキ、捨て札の状態が確認できる

**テストケース**:
- [x] 正常系: 依頼ボードで3件の進行状況が表示される
- [x] 正常系: マップ画面でノードアイコンが種類ごとに異なる
- [x] 正常系: デッキ画面で手札・デッキ・捨て札の枚数が表示される
- [x] 正常系: カードにカーソルを合わせると詳細が表示される
- [x] ユーザビリティ: 初見で操作方法が分かる

---

### 10. サウンド

#### REQ-049〜050: サウンドの受け入れ基準 🔵

**Given(前提条件)**:
- ゲームが起動している
- サウンド設定が有効

**When(実行条件)**:
- ゲームをプレイする
- 設定でBGM・SEの音量を調整する

**Then(期待結果)**:
- BGMが再生される
- SE(効果音)が再生される
- 音量調整が反映される

**テストケース**:
- [x] 正常系: タイトル画面でBGMが再生される
- [x] 正常系: カードをプレイするとSEが鳴る
- [x] 正常系: BGM音量を50%に設定→音量が半分になる
- [x] 正常系: SE音量を0%に設定→SEが鳴らない
- [x] 異常系: オーディオデバイスがない場合もエラーなく動作

---

## 非機能テスト基準

### パフォーマンステスト

#### NFR-001〜003: パフォーマンス要件 🔵

**Given(前提条件)**:
- 低スペックPC(Core i3第4世代、メモリ4GB、オンボードGPU)
- ゲームが起動している

**When(実行条件)**:
- ゲームを起動する
- カード操作を行う
- 長時間プレイする

**Then(期待結果)**:
- 起動から5秒以内にメニュー画面表示
- ゲームプレイ中に60FPS以上を維持
- カード操作の応答時間が100ms以内

**テストケース**:
- [x] 応答時間: 起動時間を10回計測→平均5秒以内
- [x] スループット: 60FPS以上を維持(低スペックPC)
- [x] 同時処理: 3件の依頼を同時進行中でもフレームレート低下なし
- [x] リソース使用量: CPU使用率50%以下、メモリ使用量2GB以下

**テスト方法**:
- 負荷テストツール: Unity Profiler
- テストシナリオ: 1時間の連続プレイでパフォーマンス計測
- 合格基準: 上記の数値基準を満たすこと

---

### セキュリティテスト

#### NFR-004: セキュリティ要件 🔵

**Given(前提条件)**:
- オフラインゲーム
- チート対策は不要

**When(実行条件)**:
- セーブデータを手動編集

**Then(期待結果)**:
- 特に制限なし(チート対策不要)

**テストケース**:
- [x] セーブデータ編集: セーブデータを手動編集しても動作する(エラーが出ないこと)
- [x] データ改ざん: 不正なデータでもクラッシュしない

---

### ユーザビリティテスト

#### NFR-005〜007: ユーザビリティ要件 🔵

**Given(前提条件)**:
- 新規プレイヤー

**When(実行条件)**:
- チュートリアルを受講
- ヘルプを参照

**Then(期待結果)**:
- 30分以内に基本操作を習得できる
- 日本語UIで操作可能
- ヘルプで操作方法を確認できる

**テストケース**:
- [x] 直感的操作性: 5名のテストプレイヤーが30分以内に基本操作を習得
- [x] 日本語UI: すべてのUIが日本語で表示される
- [x] ヘルプ機能: ヘルプ画面で操作方法を確認可能
- [x] エラーメッセージ: エラー発生時に分かりやすい日本語メッセージが表示される

**テスト方法**:
- ユーザビリティテスト: 5名の被験者に初回プレイを実施
- A/Bテスト: UI配置やカラーリングの比較テスト
- アクセシビリティチェック: 色覚多様性シミュレータで確認

---

### 保守性テスト

#### NFR-008〜009: 保守性要件 🔴

**Given(前提条件)**:
- 開発環境が整っている

**When(実行条件)**:
- カードデータを外部ファイルで編集
- ログファイルを確認

**Then(期待結果)**:
- 外部ファイル編集がゲームに反映される
- ログに必要な情報が記録されている

**テストケース**:
- [x] カードデータ編集: JSON等の外部ファイルでカードデータを変更→ゲームに反映
- [x] ログ記録: エラー発生時にログファイルに詳細が記録される
- [x] デバッグ機能: 開発者モードでデバッグ情報が表示される

---

### 移植性テスト

#### NFR-010: 移植性要件 🟡

**Given(前提条件)**:
- Unityでの開発
- iOS・Android版への移植を考慮

**When(実行条件)**:
- コードレビューを実施

**Then(期待結果)**:
- プラットフォーム依存コードが最小限
- Unity標準APIを使用している

**テストケース**:
- [x] コードレビュー: Windows専用APIの使用箇所を特定
- [x] 依存関係: 外部ライブラリのマルチプラットフォーム対応を確認

---

## Edgeケーステスト基準

### エラー処理

#### EDGE-001〜002: エラーハンドリング 🔴

**テストシナリオ**:
- セーブデータ破損
- ディスク容量不足

**期待されるエラーハンドリング**:
- エラーメッセージを表示
- ゲームがクラッシュしない
- 新規ゲームとして起動可能

**合格基準**:
- [x] システムがクラッシュしない
- [x] 適切なエラーメッセージが日本語で表示される
- [x] データの整合性が保たれる
- [x] 復旧可能な状態を維持する

**テストケース**:
- [x] セーブデータを手動で破損→エラーメッセージ表示、新規ゲームとして起動
- [x] ディスク容量0の状態でセーブ→エラーメッセージ表示、セーブ中止

---

### 境界値テスト

#### EDGE-003〜005: 境界値処理 🔴

**テストシナリオ**:
- デッキ枚数1000枚
- エネルギーがマイナス
- 安定値が0以下

**期待される動作**:
- 異常な値でもクラッシュしない
- 境界値で適切な処理が行われる

**合格基準**:
- [x] デッキ1000枚でも動作する(警告メッセージは表示可)
- [x] エネルギーがマイナスになる計算が発生しても0として扱われる
- [x] 安定値が0以下になると暴発が強制発生する

**テストケース**:
- [x] デッキ1000枚: ゲームが正常に動作、パフォーマンス低下が許容範囲内
- [x] エネルギー-10: 内部計算で0として扱われる
- [x] 安定値-5: 暴発が確定発生する

---

### データ整合性テスト

#### EDGE-006〜007: データ整合性 🔴

**テストシナリオ**:
- 依頼が4件発生
- カード進化中にデータエラー

**期待される動作**:
- データの整合性を保つ
- エラー発生時は安全な状態に復旧

**合格基準**:
- [x] 依頼が3件を超えた場合、古い依頼を自動破棄
- [x] カード進化失敗時、元のカードが保持される
- [x] データの不整合が発生しない

**テストケース**:
- [x] 依頼4件発生: 最も古い依頼が自動的に破棄される
- [x] 進化中にエラー: 進化が中止され、元のカード3枚が保持される

---

## 統合テスト基準

### システム間連携テスト

- [x] カードシステム⇔依頼システム: カードの属性値が依頼に正しく反映される
- [x] 報酬システム⇔デッキシステム: 報酬カードがデッキに追加される
- [x] メタ進行⇔セーブシステム: メタ通貨が永続保存される
- [x] UI⇔ゲームロジック: UI操作がゲームロジックに正しく反映される

---

## リグレッションテスト基準

### 既存機能影響確認

- [x] 新機能追加後: 既存の依頼達成機能が動作する
- [x] パフォーマンス: 新機能追加後も60FPS維持
- [x] セーブ互換性: 旧バージョンのセーブデータが読み込める

---

## 受け入れテスト実行チェックリスト

### テスト実行前

- [ ] テスト環境の準備完了(低スペックPC、中スペックPC、高スペックPC)
- [ ] テストデータの準備完了(正常データ、異常データ、境界値データ)
- [ ] テストツールの準備完了(Unity Profiler、色覚シミュレータ等)
- [ ] 実行担当者の確認完了

### テスト実行中

- [ ] 全機能テストの実行(上記のテストケース)
- [ ] 全非機能テストの実行(パフォーマンス、ユーザビリティ等)
- [ ] 問題発見時の記録(Issue管理システムに登録)
- [ ] 修正後の再テスト

### テスト完了後

- [ ] テスト結果の記録(合格/不合格、問題点の整理)
- [ ] 残存問題の整理(既知の問題のリスト化)
- [ ] 受け入れ可否の判定(全Must Have要件が合格)
- [ ] ステークホルダーへの報告

---

## MVP(最小限の製品)の受け入れ基準

### MVP合格条件

以下のすべてのテストに合格すること:

1. **プラットフォーム基盤**: REQ-001〜008のテスト合格
2. **データ管理**: REQ-010〜013のテスト合格
3. **基本ゲームフロー**: REQ-014〜017のテスト合格(最低1スタイル)
4. **カードシステム基本**: REQ-022〜026のテスト合格
5. **顧客システム基本**: REQ-029〜034のテスト合格
6. **報酬システム**: REQ-036のテスト合格
7. **パフォーマンス**: NFR-001〜003のテスト合格

### MVP除外項目(正式リリースでテスト)

- チュートリアル機能
- カード合成・進化システム
- メタ進行システム
- アセンション難易度
- シード値機能
- 実験ノード、魔物ノード

---

## テスト優先順位

### P0(最優先 - MVP必須)

- プラットフォーム基盤テスト
- カードシステムテスト
- 顧客依頼システムテスト
- パフォーマンステスト

### P1(高優先 - 正式リリース必須)

- メタ進行テスト
- UI/UXテスト
- サウンドテスト
- 統合テスト

### P2(中優先)

- Edgeケーステスト
- リグレッションテスト
- ユーザビリティテスト

### P3(低優先 - あれば良い)

- アセンション高難易度テスト
- シード値再現テスト

---

## 自動テスト vs 手動テスト

### 自動テスト対象

- ユニットテスト: カードロジック、属性値計算、安定値計算
- 統合テスト: セーブ・ロード機能、データ整合性
- パフォーマンステスト: 起動時間、FPS計測

### 手動テスト対象

- UI/UXテスト: 視覚的な確認
- ユーザビリティテスト: 操作性の評価
- サウンドテスト: BGM・SEの確認
- エンドツーエンドテスト: 実際のプレイフロー

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2025-11-08 | 1.0 | 初版作成 |

